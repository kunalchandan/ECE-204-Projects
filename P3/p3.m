clear all;
closereq();
ts = [0.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9 2 2.1 2.2 2.3 2.4 2.5 2.6 2.7 2.8 2.9 3 3.1 3.2 3.3 3.4 3.5 3.6 3.7 3.8 3.9 4 4.1 4.2 4.3 4.4 4.5 4.6 4.7 4.8 4.9 5 5.1 5.2 5.3 5.4 5.5 5.6 5.7 5.8 5.9 6 6.1 6.2 6.3 6.4 6.5 6.6 6.7 6.8 6.9 7 7.1 7.2 7.3 7.4 7.5 7.6 7.7 7.8 7.9 8 8.1 8.2 8.3 8.4 8.5 8.6 8.7 8.8 8.9 9 9.1 9.2 9.3 9.4 9.5 9.6 9.7 9.8 9.9 10 10.1 10.2 10.3 10.4 10.5 10.6 10.7 10.8 10.9 11 11.1 11.2 11.3 11.4 11.5 11.6 11.7 11.8 11.9 12 12.1 12.2 12.3 12.4 12.5 12.6 12.7 12.8 12.9 13 13.1 13.2 13.3 13.4 13.5 13.6 13.7 13.8 13.9 14 14.1 14.2 14.3 14.4 14.5 14.6 14.7 14.8 14.9 15 15.1 15.2 15.3 15.4 15.5 15.6 15.7 15.8 15.9 16 16.1 16.2 16.3 16.4 16.5 16.6 16.7 16.8 16.9 17 17.1 17.2 17.3 17.4 17.5 17.6 17.7 17.8 17.9 18 18.1 18.2 18.3 18.4 18.5 18.6 18.7 18.8 18.9 19 19.1 19.2 19.3 19.4 19.5 19.6 19.7 19.8 19.9 20];
y_12th_RC = [0.0 0.0147855 0.0873162 0.19368 0.264076 0.258223 0.208482 0.192864 0.264126 0.400837 0.526029 0.576598 0.559831 0.545199 0.599115 0.722569 0.849092 0.904839 0.875621 0.819238 0.811735 0.877 0.964476 0.995386 0.935051 0.824736 0.74378 0.736846 0.773086 0.77487 0.689546 0.538371 0.397513 0.328634 0.322863 0.309697 0.222541 0.0607376 -0.109039 -0.21325 -0.238278 -0.242147 -0.300354 -0.435658 -0.596415 -0.703313 -0.721628 -0.692499 -0.694518 -0.770986 -0.889616 -0.971867 -0.964818 -0.889628 -0.82192 -0.822188 -0.880192 -0.924495 -0.888299 -0.771131 -0.639606 -0.566605 -0.564747 -0.575318 -0.522862 -0.385228 -0.214614 -0.0903359 -0.0466674 -0.0421364 0.0015217 0.126612 0.29973 0.441682 0.499472 0.494277 0.501223 0.579607 0.71772 0.843036 0.888316 0.852965 0.803161 0.810684 0.886661 0.971144 0.988132 0.915445 0.805158 0.735886 0.740722 0.777128 0.766428 0.666571 0.511337 0.379844 0.324459 0.323314 0.301153 0.199285 0.03034 -0.132561 -0.222181 -0.238173 -0.246576 -0.318298 -0.463141 -0.620012 -0.712388 -0.718003 -0.688669 -0.702089 -0.789899 -0.908151 -0.977357 -0.955251 -0.875464 -0.816458 -0.829343 -0.890908 -0.925081 -0.873067 -0.747684 -0.621897 -0.562193 -0.567925 -0.572471 -0.505087 -0.356618 -0.188637 -0.077577 -0.04522 -0.0395053 0.0168103 0.154302 0.327946 0.457712 0.501318 0.492364 0.508693 0.600129 0.742014 0.857292 0.886821 0.843287 0.799114 0.819587 0.902566 0.980292 0.981591 0.897313 0.788832 0.731772 0.746708 0.780596 0.75591 0.642395 0.48541 0.364803 0.322172 0.323281 0.290287 0.174068 0.000191341 -0.153793 -0.228825 -0.237817 -0.252938 -0.338492 -0.490993 -0.641633 -0.718811 -0.713313 -0.68616 -0.71195 -0.809758 -0.925202 -0.980063 -0.943931 -0.861961 -0.813229 -0.838021 -0.900805 -0.923046 -0.855612 -0.724241 -0.606227 -0.5598 -0.571077 -0.567425 -0.484823 -0.327415 -0.164415 -0.0672328 -0.044595 -0.0353262 0.0345846 0.183098 0.354822 0.471103 0.501557];
y_2nd_but = [0.0 0.0154276 0.0948621 0.219165 0.312707 0.322255 0.272174 0.245719 0.310204 0.455333 0.601884 0.673099 0.663482 0.641935 0.686548 0.81107 0.95075 1.02058 0.992407 0.92002 0.889116 0.938113 1.02266 1.05635 0.990246 0.85812 0.745701 0.712274 0.736673 0.737307 0.647809 0.478749 0.308654 0.212609 0.194033 0.182417 0.0990022 -0.0698854 -0.259389 -0.384819 -0.41866 -0.414948 -0.45879 -0.587252 -0.754566 -0.873431 -0.894662 -0.851771 -0.829662 -0.886086 -0.9982 -1.08325 -1.07448 -0.982363 -0.884979 -0.856267 -0.898224 -0.939295 -0.900501 -0.768458 -0.608176 -0.503851 -0.482083 -0.488121 -0.436938 -0.292207 -0.100527 0.0505516 0.112137 0.118048 0.152814 0.273066 0.454576 0.613681 0.683362 0.674074 0.663384 0.723974 0.856181 0.987134 1.03726 0.993044 0.919112 0.898594 0.956532 1.0368 1.05372 0.970984 0.835204 0.733385 0.713284 0.739987 0.728517 0.622583 0.446992 0.285572 0.204875 0.193804 0.174674 0.0755044 -0.102894 -0.28678 -0.396355 -0.418264 -0.416972 -0.474681 -0.614905 -0.780134 -0.883945 -0.88986 -0.84423 -0.833165 -0.902876 -1.01687 -1.08917 -1.06325 -0.963822 -0.874177 -0.859642 -0.907723 -0.939819 -0.88386 -0.740968 -0.584951 -0.494998 -0.483536 -0.485487 -0.418869 -0.26097 -0.0700602 0.0673021 0.114974 0.119546 0.166614 0.301177 0.485388 0.632492 0.685759 0.669865 0.667457 0.7425 0.880842 1.00268 1.03547 0.980195 0.910193 0.903475 0.970876 1.04605 1.0465 0.949578 0.81351 0.724186 0.716574 0.743056 0.717734 0.596041 0.416373 0.265538 0.199721 0.193652 0.164698 0.0497138 -0.135998 -0.311866 -0.405209 -0.417189 -0.420853 -0.493155 -0.643378 -0.803871 -0.891514 -0.883522 -0.837788 -0.839186 -0.921057 -1.03428 -1.09211 -1.04979 -0.945604 -0.865701 -0.864959 -0.91675 -0.93766 -0.864568 -0.713092 -0.563766 -0.488569 -0.485411 -0.480759 -0.398009 -0.228726 -0.0412391 0.0812992 0.116491 0.122353 0.183109 0.330821 0.515072 0.648432 0.686049];
y_12th_bu = [0.0 1.3674e-16 9.27728e-13 1.47811e-10 5.03321e-09 7.31793e-08 6.18366e-07 3.58042e-06 1.56769e-05 5.53334e-05 0.000164527 0.000425426 0.000979784 0.00204741 0.00393952 0.00706367 0.0119183 0.0190766 0.0291607 0.0428074 0.0606274 0.0831625 0.110843 0.143954 0.1826 0.226696 0.275951 0.329872 0.387773 0.44879 0.511905 0.575977 0.639769 0.701982 0.761291 0.816371 0.865938 0.908776 0.943774 0.969949 0.986477 0.992714 0.98821 0.972728 0.946244 0.908951 0.861247 0.803722 0.737134 0.662386 0.580492 0.492549 0.399706 0.30313 0.203978 0.10338 0.00241594 -0.0978918 -0.196584 -0.292769 -0.385614 -0.474346 -0.558243 -0.636622 -0.708835 -0.774268 -0.832335 -0.88249 -0.924223 -0.957075 -0.980648 -0.994614 -0.998734 -0.992868 -0.976983 -0.951165 -0.91562 -0.870677 -0.816781 -0.754494 -0.684478 -0.607491 -0.524364 -0.435992 -0.343318 -0.247316 -0.148982 -0.0493197 0.050671 0.150004 0.247711 0.342854 0.43452 0.521836 0.603969 0.68013 0.749585 0.811655 0.865722 0.91124 0.947737 0.974826 0.99221 0.999689 0.997163 0.984633 0.962207 0.930099 0.888626 0.838209 0.779361 0.712683 0.638859 0.558645 0.472858 0.382372 0.288104 0.191001 0.0920368 -0.00780357 -0.107529 -0.20615 -0.302694 -0.396207 -0.485767 -0.57049 -0.649537 -0.722124 -0.787526 -0.845087 -0.89423 -0.934459 -0.965363 -0.986627 -0.998029 -0.999449 -0.990866 -0.972364 -0.944127 -0.906438 -0.859674 -0.804307 -0.740894 -0.670075 -0.592563 -0.509138 -0.420636 -0.327942 -0.231985 -0.133722 -0.0341353 0.0657826 0.165037 0.26264 0.357621 0.449033 0.535964 0.617547 0.692969 0.761475 0.822382 0.875078 0.919035 0.95381 0.979054 0.994513 1.00003 0.995555 0.981124 0.956884 0.923077 0.880043 0.828213 0.768108 0.700328 0.625552 0.544527 0.458065 0.36703 0.272332 0.174918 0.0757579 -0.0241576 -0.123831 -0.222268 -0.318484 -0.411518 -0.500443 -0.584371 -0.662464 -0.733939 -0.798083 -0.854253 -0.901889 -0.940513 -0.96974 -0.989278 -0.998929 -0.998596 -0.988284 -0.968096];
phase = -2.46797;
%phase = -3.69803;

ix = find ( (ts+phase) > 0, 1, 'first');
t_m = (ts + phase)(ix:end);
hold on;

%plot (t_m, y_12th_RC(ix:end));
plot (ts, y_2nd_but);
plot (t_m, y_12th_bu(ix:end));
plot (ts, sin(ts) + sin(10*ts));
plot (ts, sin(ts));

plot (t_m, (y_12th_bu(ix:end) - sin((ts + phase)(ix:end))).^2)
hold off;
